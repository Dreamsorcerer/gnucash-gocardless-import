name: CI

on:
  merge_group:
  push:
    branches:
      - 'master'
  pull_request:

permissions: {}
jobs:
  lint:
    permissions:
      contents: read # to fetch code (actions/checkout)

    name: Mypy
    runs-on: ubuntu-latest
    timeout-minutes: 5
    steps:
    - name: Checkout
      uses: actions/checkout@v4
    - name: Setup Python
      uses: actions/setup-python@v5
      with:
        python-version: 3.11
        cache: 'pip'
        cache-dependency-path: '**/requirements*.txt'
    - name: Install gnucash
      run: sudo apt install python3-gnucash -y
    - name: Install dependencies
      uses: py-actions/py-dependency-install@v4
      with:
        path: requirements.txt
    - name: Run mypy
      run: mypy gnucash_import.py --strict
